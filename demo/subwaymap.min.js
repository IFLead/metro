angular.module("dvhbSubwayMap",[]),function(t){"use strict";function n(){function n(n,i,o,e,a){function s(){c.resolve(),t.forEach(u,function(t){f[t]=f[t]||{},f[t].isDisabled=n.stations?!r(n.stations,t):!0})}function r(n,i){return t.isArray(n)?-1!=n.indexOf(i):t.isObject(n)?t.isDefined(n[i]):!1}var u,c,c=a.defer(),l=this,f={};n.subwayInfo=null,u=o[0].querySelectorAll("[subway-station-name]"),u=[].map.call(u,function(t){return t.attributes["subway-station-name"].nodeValue}),s(),l.setSubwayInfo=function(t){n.subwayInfo=t},l.onSelectStation=function(i,o){(n.subwayInfo.show||t.noop)(o),(n.onSelect||t.noop)(i,o)},l.findStation=function(n){var i=f[n];return t.isDefined(i)?i:{}},n.$watch("stations",s,!0)}function i(n,i){i.css("position","relative"),i.on("click",function(i){i.originalEvent.fromStation||(n.subwayInfo.hide||t.noop)()})}return n.$inject=["$scope","$http","$element","$attrs","$q"],{restrict:"AE",replace:!1,transclude:!0,controller:n,controllerAs:"subwayMap",link:i,templateUrl:function(t,n){return n.mapUrl||"./metro.svg"},scope:{stations:"=?",onSelect:"=?"}}}t.module("dvhbSubwayMap").directive("subwayMap",n)}(angular),function(t){"use strict";function n(){function t(t,n,i,o){function e(){for(var t,i,o=n.find("circle"),e=o.length-1;e>=0;e--)if(o.eq(e).hasClass("subway-point")){t=o[e],i=t.getBoundingClientRect();break}return i?$(t).position():null}function a(n){t.data.isDisabled||(n.originalEvent.fromStation=!0,u.onSelectStation([r],e())),!t.data.isDisabled&&u.multiple&&(t.data.isActive=!t.data.isActive)}function s(){r=i.subwayStationName,n.bind("click",a);var o=u.findStation(r);o&&(t.data=o,c&&c.registerStation(r,o),t.$watch("data.isDisabled",function(t){n.toggleClass("disabled",t)}))}var r,u=o[1],c=o[0];s()}return{require:["?^subwayStationGroup","^subwayMap"],restrict:"A",link:t,scope:{}}}t.module("dvhbSubwayMap").directive("subwayStationName",n)}(angular),function(t){"use strict";function n(){function n(n,i,o,e){function a(n){return t.extend(n,c)}function s(t){var o=t.left,e=t.top;n.offset&&n.offset.left&&(o+=n.offset.left),n.offset&&n.offset.top&&(e+=n.offset.top),i.css("display","block"),i.css("left",o),i.css("top",e)}function r(){i.css("display","none")}function u(){i.css("position","absolute"),r(),l.setSubwayInfo(a({},c)),n.control&&a(n.control)}var c,l=e[0];c={show:s,hide:r},u()}return{require:["^subwayMap"],restrict:"A",link:n,scope:{control:"=?",offset:"=?"}}}t.module("dvhbSubwayMap").directive("subwayInfo",n)}(angular),function(t){"use strict";function n(){function n(t){t.stations={},t.main="",this.registerStation=function(n,i){t.stations[n]=i,t.main=n}}function i(n,i,o,e){function a(){var i=!0;return t.forEach(n.stations,function(t){t.isDisabled===!1&&(i=!1)}),i}n.$watch(a,function(t){i.toggleClass("disabled",t)}),i.find("text").bind("click",function(t){var i=[];if(!a()){for(var o in n.stations)o.isDisabled||i.push(o);var s=$(t.target).position();e.onSelectStation(i,s)}})}return n.$inject=["$scope","$element"],{restrict:"A",link:i,require:"^subwayMap",controller:n,replace:!1,scope:{}}}t.module("dvhbSubwayMap").directive("subwayStationGroup",n)}(angular);