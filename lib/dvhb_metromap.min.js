angular.module("dvhbMetroMap",[]),function(t){"use strict";function n(){function n(n,o,e,i,r){function a(){l.resolve(),t.forEach(c,function(t,o){u[t]=u[t]||{},u[t].isDisabled=n.stations?!s(n.stations,t):!0})}function s(n,o){return t.isArray(n)?-1!=n.indexOf(o):t.isObject(n)?t.isDefined(n[o]):!1}var c,l=r.defer(),f=this,u={};n.metroInfo=null,c=e[0].querySelectorAll("[metro-station-name]"),c=[].map.call(c,function(t){return t.attributes["metro-station-name"].nodeValue}),a(),f.setMetroInfo=function(t){n.metroInfo=t},f.onSelectStation=function(o,i){var r=e[0].getBoundingClientRect();i={left:i.left-r.left,top:i.top-r.top},(n.metroInfo.show||t.noop)(i),(n.onSelect||t.noop)(o,i)},f.findStation=function(n){var o=u[n];return t.isDefined(o)?o:{}},n.$watch("stations",a,!0)}function o(n,o,e){o.css("position","relative"),o.on("click",function(o){o.originalEvent.data&&o.originalEvent.data.fromStation||(n.metroInfo.hide||t.noop)()})}return n.$inject=["$scope","$http","$element","$attrs","$q"],{restrict:"AE",replace:!1,transclude:!0,controller:n,controllerAs:"metroMap",link:o,templateUrl:function(t,n){return n.mapUrl||"./metro.svg"},scope:{stations:"=?",onSelect:"=?"}}}t.module("dvhbMetroMap").directive("metroMap",n)}(angular),function(t){"use strict";function n(){function t(t,n,o,e){function i(){for(var t,o,e=n.find("circle"),i=e.length-1;i>=0;i--)if(e[i].classList.contains("metro-point")){t=e[i],o=t.getBoundingClientRect();break}return o?{left:o.left,top:o.top}:null}function r(n){t.data.isDisabled||(n.originalEvent.data={fromStation:!0},c.onSelectStation([s],i())),!t.data.isDisabled&&c.multiple&&(t.data.isActive=!t.data.isActive)}function a(){s=o.metroStationName,n.bind("click",r);var e=c.findStation(s);e&&(t.data=e,l&&l.registerStation(s,e),t.$watch("data.isDisabled",function(t){n[0].classList.toggle("disabled",t)}))}var s,c=e[1],l=e[0];a()}return{require:["?^metroStationGroup","^metroMap"],restrict:"A",link:t,scope:{}}}t.module("dvhbMetroMap").directive("metroStationName",n)}(angular),function(t){"use strict";function n(){function n(n,o,e,i){function r(n){return t.extend(n,f)}function a(t){var e=t.left,i=t.top;n.offset&&n.offset.left&&(e+=n.offset.left||0),n.offset&&n.offset.top&&(i+=n.offset.top||0),o.css("left",e+"px"),o.css("top",i+"px"),o.css("display","block")}function s(){o.css("display","none")}function c(){return"block"==o.css("display")}function l(){o.css("position","absolute"),s(),u.setMetroInfo(r({})),n.control&&r(n.control)}var f,u=i[0];f={show:a,hide:s,isOpen:c},l()}return{require:["^metroMap"],restrict:"A",link:n,scope:{control:"=?",offset:"=?"}}}t.module("dvhbMetroMap").directive("metroInfo",n)}(angular),function(t){"use strict";function n(){function n(t,n){t.stations={},t.main="",this.registerStation=function(n,o){t.stations[n]=o,t.main=n}}function o(n,o,e,i){function r(){var o=!0;return t.forEach(n.stations,function(t,n){t.isDisabled===!1&&(o=!1)}),o}n.$watch(r,function(t){o[0].classList.toggle("disabled",t)}),o.find("text").bind("click",function(t){var o=[];if(!r()){for(var e in n.stations)e.isDisabled||o.push(e);t.originalEvent.data={fromStation:!0};var a=$(t.target).position();i.onSelectStation(o,a)}})}return n.$inject=["$scope","$element"],{restrict:"A",link:o,require:"^metroMap",controller:n,replace:!1,scope:{}}}t.module("dvhbMetroMap").directive("metroStationGroup",n)}(angular);