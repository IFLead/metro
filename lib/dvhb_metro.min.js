angular.module("dvhbMetro",[]),function(t){"use strict";function n(){function n(n,e,o,i,r){function a(){l.resolve(),t.forEach(c,function(t,e){u[t]=u[t]||{},u[t].isDisabled=n.stations?!s(n.stations,t):!0})}function s(n,e){return t.isArray(n)?-1!=n.indexOf(e):t.isObject(n)?t.isDefined(n[e]):!1}var c,l=r.defer(),f=this,u={};n.metroInfo=null,c=o[0].querySelectorAll("[metro-station-name]"),c=[].map.call(c,function(t){return t.attributes["metro-station-name"].nodeValue}),a(),f.setMetroInfo=function(t){n.metroInfo=t},f.onSelectStation=function(e,i){var r=o[0].getBoundingClientRect();i={left:i.left-r.left,top:i.top-r.top},(n.metroInfo.show||t.noop)(i),(n.onSelect||t.noop)(e,i)},f.findStation=function(n){var e=u[n];return t.isDefined(e)?e:{}},n.$watch("stations",a,!0)}function e(n,e,o){e.css("position","relative"),e.on("click",function(e){e.originalEvent.data&&e.originalEvent.data.fromStation||(n.metroInfo.hide||t.noop)()})}return n.$inject=["$scope","$http","$element","$attrs","$q"],{restrict:"AE",replace:!1,transclude:!0,controller:n,controllerAs:"metro",link:e,templateUrl:function(t,n){return n.mapUrl||"./metro.svg"},scope:{stations:"=?",onSelect:"=?"}}}t.module("dvhbMetro").directive("metro",n)}(angular),function(t){"use strict";function n(){function t(t,n,e,o){function i(){for(var t,e,o=n.find("circle"),i=o.length-1;i>=0;i--)if(o[i].classList.contains("metro-point")){t=o[i],e=t.getBoundingClientRect();break}return e?{left:e.left,top:e.top}:null}function r(n){t.data.isDisabled||(n.originalEvent.data={fromStation:!0},c.onSelectStation([s],i())),!t.data.isDisabled&&c.multiple&&(t.data.isActive=!t.data.isActive)}function a(){s=e.metroStationName,n.bind("click",r);var o=c.findStation(s);o&&(t.data=o,l&&l.registerStation(s,o),t.$watch("data.isDisabled",function(t){n[0].classList.toggle("disabled",t)}))}var s,c=o[1],l=o[0];a()}return{require:["?^metroStationGroup","^metro"],restrict:"A",link:t,scope:{}}}t.module("dvhbMetro").directive("metroStationName",n)}(angular),function(t){"use strict";function n(){function n(n,e,o,i){function r(n){return t.extend(n,f)}function a(t){var o=t.left,i=t.top;n.offset&&n.offset.left&&(o+=n.offset.left||0),n.offset&&n.offset.top&&(i+=n.offset.top||0),e.css("left",o+"px"),e.css("top",i+"px"),e.css("display","block")}function s(){e.css("display","none")}function c(){return"block"==e.css("display")}function l(){e.css("position","absolute"),s(),u.setMetroInfo(r({})),n.control&&r(n.control)}var f,u=i[0];f={show:a,hide:s,isOpen:c},l()}return{require:["^metro"],restrict:"A",link:n,scope:{control:"=?",offset:"=?"}}}t.module("dvhbMetro").directive("metroInfo",n)}(angular),function(t){"use strict";function n(){function n(t,n){t.stations={},t.main="",this.registerStation=function(n,e){t.stations[n]=e,t.main=n}}function e(n,e,o,i){function r(){var e=!0;return t.forEach(n.stations,function(t,n){t.isDisabled===!1&&(e=!1)}),e}n.$watch(r,function(t){e[0].classList.toggle("disabled",t)}),e.find("text").bind("click",function(t){var e=[];if(!r()){for(var o in n.stations)o.isDisabled||e.push(o);t.originalEvent.data={fromStation:!0};var a=t.target.getBoundingClientRect();i.onSelectStation(e,a)}})}return n.$inject=["$scope","$element"],{restrict:"A",link:e,require:"^metro",controller:n,replace:!1,scope:{}}}t.module("dvhbMetro").directive("metroStationGroup",n)}(angular);